{
  "_metadata": {
    "version": "1.0.0",
    "description": "Declarative issue detection rules for detectInitialIssues(). Each rule specifies event patterns (present/absent) and generates an issue when matched.",
    "lastUpdated": "2025-07-21"
  },
  "rules": [
    {
      "id": "creation_failure",
      "patterns": {
        "present": [
          "WebView2_CreationFailure"
        ],
        "absent": []
      },
      "severity": "critical",
      "message": "ğŸ”´ WebView2 creation FAILED",
      "evidenceTemplate": "WebView2_CreationFailure detected â€” check HRESULT and WebView2_CreationFailureExe for details"
    },
    {
      "id": "factory_connection_error",
      "patterns": {
        "present": [
          "WebView2_FactoryConnectionError"
        ],
        "absent": []
      },
      "severity": "critical",
      "message": "ğŸ”´ Factory IPC connection to browser process FAILED",
      "evidenceTemplate": "WebView2_FactoryConnectionError â€” browser process may not have started or crashed during connection"
    },
    {
      "id": "browser_process_crash",
      "patterns": {
        "present": [
          "WebView2_BrowserProcessFailure"
        ],
        "absent": []
      },
      "severity": "critical",
      "message": "ğŸ”´ Browser process CRASHED",
      "evidenceTemplate": "WebView2_BrowserProcessFailure with exit_code â€” all WebView2 instances affected"
    },
    {
      "id": "renderer_unresponsive",
      "patterns": {
        "present": [
          "WebView2_RendererUnresponsive"
        ],
        "absent": []
      },
      "severity": "warning",
      "message": "ğŸŸ¡ Renderer became UNRESPONSIVE",
      "evidenceTemplate": "WebView2_RendererUnresponsive â€” heavy JS or infinite loop suspected"
    },
    {
      "id": "process_failure_with_exit_code",
      "patterns": {
        "present": [
          "WebView2_ProcessFailureTypeWithExitCode"
        ],
        "absent": []
      },
      "severity": "critical",
      "message": "ğŸ”´ Process failure with non-zero exit code",
      "evidenceTemplate": "WebView2_ProcessFailureTypeWithExitCode â€” check exit code and process type"
    },
    {
      "id": "process_failure_with_reason",
      "patterns": {
        "present": [
          "WebView2_ProcessFailureTypeWithReason"
        ],
        "absent": []
      },
      "severity": "critical",
      "message": "ğŸ”´ Process failure with specific reason",
      "evidenceTemplate": "WebView2_ProcessFailureTypeWithReason â€” check failure reason"
    },
    {
      "id": "navigation_request_failed",
      "patterns": {
        "present": [
          "NavigationRequest::OnRequestFailedInternal"
        ],
        "absent": []
      },
      "severity": "warning",
      "message": "ğŸŸ¡ Navigation request FAILED in browser",
      "evidenceTemplate": "NavigationRequest::OnRequestFailedInternal â€” network/SSL/server error"
    },
    {
      "id": "navigation_id_mismatch",
      "patterns": {
        "present": [
          "WebView2_DifferentNavigationId"
        ],
        "absent": []
      },
      "severity": "warning",
      "message": "ğŸŸ¡ Navigation ID mismatch â€” event may be suppressed",
      "evidenceTemplate": "WebView2_DifferentNavigationId â€” about:blank suppression or stale navigation ID"
    },
    {
      "id": "event_dropped",
      "patterns": {
        "present": [
          "WebView2_DroppedEvent"
        ],
        "absent": []
      },
      "severity": "warning",
      "message": "ğŸŸ¡ Event DROPPED â€” dispatch failed",
      "evidenceTemplate": "WebView2_DroppedEvent â€” event constructed but not delivered to host"
    },
    {
      "id": "no_event_dispatcher",
      "patterns": {
        "present": [
          "WebView2_NoEventDispatcher"
        ],
        "absent": []
      },
      "severity": "warning",
      "message": "ğŸŸ¡ No event dispatcher registered for event type",
      "evidenceTemplate": "WebView2_NoEventDispatcher â€” handler not registered before event fired"
    },
    {
      "id": "invalid_version",
      "patterns": {
        "present": [
          "WebView2_Invalid_Version"
        ],
        "absent": []
      },
      "severity": "critical",
      "message": "ğŸ”´ WebView2 runtime version INVALID",
      "evidenceTemplate": "WebView2_Invalid_Version â€” runtime installation may be corrupted"
    },
    {
      "id": "version_too_old",
      "patterns": {
        "present": [
          "WebView2_version_too_old"
        ],
        "absent": []
      },
      "severity": "critical",
      "message": "ğŸ”´ WebView2 runtime version TOO OLD for requested SDK features",
      "evidenceTemplate": "WebView2_version_too_old â€” update runtime or lower SDK version requirement"
    },
    {
      "id": "launch_process_failed",
      "patterns": {
        "present": [
          "WebView2_LaunchProcess_Failed"
        ],
        "absent": []
      },
      "severity": "critical",
      "message": "ğŸ”´ Failed to launch browser process",
      "evidenceTemplate": "WebView2_LaunchProcess_Failed â€” check exe path, permissions, antivirus blocks"
    },
    {
      "id": "window_init_failed",
      "patterns": {
        "present": [
          "WebView2_WindowImpl_Init_Failed"
        ],
        "absent": []
      },
      "severity": "critical",
      "message": "ğŸ”´ Window initialization FAILED â€” possibly headless/service context",
      "evidenceTemplate": "WebView2_WindowImpl_Init_Failed â€” no interactive desktop available?"
    },
    {
      "id": "invalid_window",
      "patterns": {
        "present": [
          "WebView2_InvalidWindow"
        ],
        "absent": []
      },
      "severity": "warning",
      "message": "ğŸŸ¡ Invalid window handle detected",
      "evidenceTemplate": "WebView2_InvalidWindow â€” parent window may have been destroyed"
    },
    {
      "id": "wam_auth_error",
      "patterns": {
        "present": [
          "WebTokenRequestResultOperation_ActivityError"
        ],
        "absent": []
      },
      "severity": "warning",
      "message": "ğŸŸ¡ WAM authentication error",
      "evidenceTemplate": "WebTokenRequestResultOperation_ActivityError â€” check HRESULT for network/auth details"
    },
    {
      "id": "response_loading_blocked",
      "patterns": {
        "present": [
          "WebView2_ResponseLoadingBlocked"
        ],
        "absent": []
      },
      "severity": "warning",
      "message": "ğŸŸ¡ HTTP response loading BLOCKED",
      "evidenceTemplate": "WebView2_ResponseLoadingBlocked â€” content blocked by proxy, CORS, or CSP"
    },
    {
      "id": "cdp_method_failed",
      "patterns": {
        "present": [
          "WebView2_CallCDPMethodFailed"
        ],
        "absent": []
      },
      "severity": "warning",
      "message": "ğŸŸ¡ DevTools Protocol method call FAILED",
      "evidenceTemplate": "WebView2_CallCDPMethodFailed â€” CDP communication issue with renderer"
    },
    {
      "id": "suspend_memory_cancelled",
      "patterns": {
        "present": [
          "WebView2_CollectSuspendMemoryCancelled"
        ],
        "absent": []
      },
      "severity": "info",
      "message": "â„¹ï¸ Suspend memory collection cancelled (audio/video may be playing)",
      "evidenceTemplate": "WebView2_CollectSuspendMemoryCancelled â€” TrySuspend rejected"
    },
    {
      "id": "descendants_timeout",
      "patterns": {
        "present": [
          "WebView2_WaitForDescendantsTimeOut"
        ],
        "absent": []
      },
      "severity": "warning",
      "message": "ğŸŸ¡ Timed out waiting for descendant processes to exit",
      "evidenceTemplate": "WebView2_WaitForDescendantsTimeOut â€” processes not cleaning up after browser exit"
    },
    {
      "id": "forced_process_termination",
      "patterns": {
        "present": [
          "WebView2_WatcherTerminateProcess"
        ],
        "absent": []
      },
      "severity": "warning",
      "message": "ğŸŸ¡ Process FORCIBLY TERMINATED after shutdown timeout",
      "evidenceTemplate": "WebView2_WatcherTerminateProcess â€” process did not exit gracefully"
    },
    {
      "id": "service_worker_fallback",
      "patterns": {
        "present": [
          "FetchHandlerEndToFallbackNetwork"
        ],
        "absent": []
      },
      "severity": "info",
      "message": "â„¹ï¸ Service worker fell back to network (cache miss)",
      "evidenceTemplate": "FetchHandlerEndToFallbackNetwork â€” SW did not serve from cache"
    },
    {
      "id": "incompatible_config",
      "patterns": {
        "present": [
          "WebView2_IncompatibleConfig"
        ],
        "absent": []
      },
      "severity": "critical",
      "message": "ğŸ”´ Incompatible WebView2 configuration detected",
      "evidenceTemplate": "WebView2_IncompatibleConfig â€” check for conflicting settings or environment"
    },
    {
      "id": "first_navigation_failed",
      "patterns": {
        "present": [
          "WebView2_FirstNavigationFailed"
        ],
        "absent": []
      },
      "severity": "critical",
      "message": "ğŸ”´ First navigation after creation FAILED",
      "evidenceTemplate": "WebView2_FirstNavigationFailed â€” initial page load did not succeed"
    },
    {
      "id": "shared_memory_failed",
      "patterns": {
        "present": [
          "WebView2_CreateSharedMemoryRegionFailed"
        ],
        "absent": []
      },
      "severity": "critical",
      "message": "ğŸ”´ Shared memory allocation FAILED",
      "evidenceTemplate": "WebView2_CreateSharedMemoryRegionFailed â€” system may be low on memory"
    },
    {
      "id": "nav_blocked_pending_commit",
      "patterns": {
        "present": [
          "kBlockedByPendingCommit"
        ],
        "absent": []
      },
      "severity": "warning",
      "message": "ğŸŸ¡ Navigation BLOCKED by pending about:blank commit",
      "evidenceTemplate": "kBlockedByPendingCommit â€” real navigation deferred until about:blank completes. Check service worker activation."
    },
    {
      "id": "throttling_url_loader_stall",
      "patterns": {
        "present": [
          "ThrottlingURLLoader::OnReceiveResponse"
        ],
        "absent": [
          "NavigationRequest::DidCommitNavigation"
        ]
      },
      "severity": "warning",
      "message": "ğŸŸ¡ Network response received but commit never happened",
      "evidenceTemplate": "ThrottlingURLLoader::OnReceiveResponse present but DidCommitNavigation missing â€” response may be blocked or deferred"
    },
    {
      "id": "iframe_torn_mid_navigation",
      "patterns": {
        "present": [
          "WebView2_IFrameNotFound"
        ],
        "absent": []
      },
      "severity": "warning",
      "message": "ğŸŸ¡ IFrame torn down mid-navigation â€” events will be silently dropped",
      "evidenceTemplate": "WebView2_IFrameNotFound â€” frame destroyed during active navigation lifecycle"
    },
    {
      "id": "shutdown_race_launch_failure",
      "patterns": {
        "present": [
          "WebView2_FactoryCreate"
        ],
        "absent": [
          "WebView2_FactoryAcquired"
        ]
      },
      "severity": "critical",
      "message": "ğŸ”´ WebView2 factory created but never acquired â€” possible shutdown race",
      "evidenceTemplate": "WebView2_FactoryCreate without WebView2_FactoryAcquired â€” another WV2 shutdown may be blocking"
    }
  ]
}
